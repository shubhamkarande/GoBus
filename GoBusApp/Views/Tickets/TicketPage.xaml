<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:GoBusApp.ViewModels"
             x:Class="GoBusApp.Views.Tickets.TicketPage"
             x:DataType="viewmodels:TicketViewModel"
             Title="Your Ticket"
             BackgroundColor="{StaticResource Background}">

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="16">
            
            <!-- Ticket Card -->
            <Frame Style="{StaticResource CardFrame}" Padding="24">
                <VerticalStackLayout Spacing="16">
                    
                    <!-- Header -->
                    <HorizontalStackLayout HorizontalOptions="Center" Spacing="8">
                        <Label Text="ðŸŽ«" FontSize="24"/>
                        <Label Text="E-Ticket" FontSize="20" FontAttributes="Bold"/>
                    </HorizontalStackLayout>
                    
                    <BoxView HeightRequest="2" Color="{StaticResource Primary}"/>
                    
                    <!-- Route -->
                    <Grid ColumnDefinitions="*,Auto,*">
                        <VerticalStackLayout>
                            <Label Text="{Binding Ticket.DepartureTime, StringFormat='{0:hh:mm tt}'}" 
                                   FontSize="22" 
                                   FontAttributes="Bold"/>
                            <Label Text="{Binding Ticket.Source}" 
                                   FontSize="14" 
                                   TextColor="{StaticResource TextSecondary}"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                            <Label Text="ðŸšŒ" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="â†’" FontSize="20" TextColor="{StaticResource Primary}" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Column="2" HorizontalOptions="End">
                            <Label Text="{Binding Ticket.ArrivalTime, StringFormat='{0:hh:mm tt}'}" 
                                   FontSize="22" 
                                   FontAttributes="Bold" 
                                   HorizontalOptions="End"/>
                            <Label Text="{Binding Ticket.Destination}" 
                                   FontSize="14" 
                                   TextColor="{StaticResource TextSecondary}" 
                                   HorizontalOptions="End"/>
                        </VerticalStackLayout>
                    </Grid>
                    
                    <BoxView HeightRequest="1" Color="{StaticResource Gray200}"/>
                    
                    <!-- Details Grid -->
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" RowSpacing="16" ColumnSpacing="16">
                        
                        <VerticalStackLayout Grid.Row="0" Grid.Column="0">
                            <Label Text="Bus" FontSize="12" TextColor="{StaticResource TextSecondary}"/>
                            <Label Text="{Binding Ticket.BusName}" FontSize="14" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Row="0" Grid.Column="1">
                            <Label Text="Bus No." FontSize="12" TextColor="{StaticResource TextSecondary}"/>
                            <Label Text="{Binding Ticket.BusNumber}" FontSize="14" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Row="1" Grid.Column="0">
                            <Label Text="Date" FontSize="12" TextColor="{StaticResource TextSecondary}"/>
                            <Label Text="{Binding Ticket.DepartureTime, StringFormat='{0:ddd, dd MMM}'}" FontSize="14" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Row="1" Grid.Column="1">
                            <Label Text="Seats" FontSize="12" TextColor="{StaticResource TextSecondary}"/>
                            <Label Text="{Binding Ticket.FormattedSeats}" FontSize="14" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Row="2" Grid.Column="0">
                            <Label Text="Passenger" FontSize="12" TextColor="{StaticResource TextSecondary}"/>
                            <Label Text="{Binding Ticket.PassengerName}" FontSize="14" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Row="2" Grid.Column="1">
                            <Label Text="Amount Paid" FontSize="12" TextColor="{StaticResource TextSecondary}"/>
                            <Label Text="{Binding Ticket.FormattedAmount}" FontSize="14" FontAttributes="Bold" TextColor="{StaticResource Success}"/>
                        </VerticalStackLayout>
                        
                    </Grid>
                    
                    <BoxView HeightRequest="1" Color="{StaticResource Gray200}"/>
                    
                    <!-- QR Code -->
                    <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
                        <Label Text="Scan at boarding" 
                               FontSize="12" 
                               TextColor="{StaticResource TextSecondary}"
                               HorizontalOptions="Center"/>
                        <Frame BackgroundColor="White" 
                               Padding="16" 
                               CornerRadius="8"
                               BorderColor="{StaticResource Gray300}"
                               HorizontalOptions="Center">
                            <Image Source="{Binding QrCodeImage}" 
                                   WidthRequest="180" 
                                   HeightRequest="180"
                                   Aspect="AspectFit"/>
                        </Frame>
                        <Label Text="{Binding BookingId, StringFormat='Booking: {0}'}" 
                               FontSize="10" 
                               TextColor="{StaticResource TextSecondary}"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                    
                </VerticalStackLayout>
            </Frame>
            
            <!-- Actions -->
            <VerticalStackLayout Spacing="12">
                <Button Text="ðŸ“¤ Share Ticket"
                        Style="{StaticResource SecondaryButton}"
                        Command="{Binding ShareTicketCommand}"/>
                
                <Button Text="ðŸ  Back to Home"
                        Style="{StaticResource PrimaryButton}"
                        Command="{Binding GoHomeCommand}"/>
            </VerticalStackLayout>
            
            <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}"/>
            
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
